# 🍭 你不知道的JavaScript
## 2 词法作用域
### 2.1 词法阶段
#### 查找
:::tip
- 遮蔽效应：作用域查找会在找到第一个匹配的标识符时停止（内部的标识符“遮蔽”了外部的标识符）。
:::
作用域查找始终从运行时所处的最内部作用域开始，逐级向外或者说向上进行，直到遇见第一个匹配的标识符为止。

### 2.2 欺骗语法
#### 2.2.1 `eval`
> `JavaScript` 中的 `eval(...)` 函数可以接受一个字符串为参数，并将其中的内容视为好像在书写时就存在于程序中这个位置的代码。

```
function foo(str, a){
  eval(str);  // 欺骗！
  console.log(a, b);
}

var b = 2;

foo( 'var b = 3;', 1);  // 1,3
```
- `eval(...)` 调用中的 'var b = 3;' 这段代码会被当作本来就在那里一样来处理。
- 被用来执行动态创建的代码

:::tip
在严格模式的程序中，`eval(...)` 在运行时有其自己的语法作用域，意味着其中的声明无碍法修改所在的作用域。
```
function foo(str){
  "use strict";
  eval(str);
  console.log(a); // a is not defined
}

foo('var a = 2');
```
:::

:::warning 不提倡使用
- `setTimeout(...)` 和 `setInterval(...)` 的第一个参数可以是字符串，字符串的内容可以被解释为一段动态生成的函数代码。
- `new Function(...)` 函数的最后一个参数可以接受代码字符串，并将其转化为动态生成的函数（前面的参数是这个新生成的函数的形参）。
:::